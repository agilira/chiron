<!DOCTYPE html>
<html lang="<%- page.lang || 'en' %>" data-theme="light">
<head>
    <%- include('partials/head', { page, pathToRoot, metaTags, adobeFonts, structuredData, analytics, externalStyles }) %>
</head>
<body id="<%- bodyId %>" class="<%- bodyClasses.join(' ') %>">
    <!-- Skip Link -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <!-- SVG Icon Sprite (hidden, for <use> references) -->
    {{SVG_SPRITE}}
    
    <!-- Header -->
    <%- include('partials/header', { githubUrl, logoImages, projectNameSpan, headerNav, headerActions }) %>

    <!-- Main Layout -->
    <div class="layout<% if (hideSidebar) { %> no-sidebar<% } %>">
        <% if (!hideSidebar) { %>
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar" role="complementary" aria-label="Sidebar">
            <!-- Mobile Header Navigation -->
            <nav class="mobile-header-nav" aria-label="Main navigation (mobile)">
                <%- mobileHeaderNav %>
            </nav>
            
            <!-- Sidebar Navigation -->
            <nav class="sidebar-nav" <%= aria('aria_nav_sidebar') %>>
                <%- navigation %>
            </nav>
        </aside>
        <% } else { %>
        <!-- Mobile Menu Only (when sidebar is hidden) -->
        <aside class="sidebar mobile-only" id="sidebar" role="complementary" <%= aria('aria_nav_mobile') %>>
            <nav class="mobile-header-nav" <%= aria('aria_nav_main') %>>
                <%- mobileHeaderNav %>
            </nav>
        </aside>
        <% } %>

        <!-- Main Content -->
        <main class="main-content" id="main-content" role="main">
            <div class="content-container">
                <%- breadcrumb %>

                <!-- Page Content -->
                <div class="content">
                    <!-- Featured Image -->
                    <% if (typeof the_featured_image !== 'undefined' && page.featured_image) { %>
                    <figure class="blog-featured-image">
                        <%- the_featured_image(page, { loading: 'eager' }) %>
                    </figure>
                    <% } %>
                    
                    <!-- Blog Post Header -->
                    <% if (typeof the_date !== 'undefined' && (page.author || page.date)) { %>
                    <header class="blog-post-header">
                        <% if (page.date) { %>
                        <div class="blog-meta-date">
                            <%= the_date(page, 'long', page.lang) %>
                        </div>
                        <% } %>
                        
                        <% if (page.author) { %>
                        <div class="blog-meta-author">
                            <%- the_author(page, { 
                                before: 'By ',
                                link: true, 
                                avatar: true, 
                                showSocial: true 
                            }) %>
                        </div>
                        <% } %>
                        
                        <% if (typeof the_time !== 'undefined' && page.content) { %>
                        <div class="blog-meta-reading-time">
                            <%= the_time(page, { 
                                before: '⏱️ ',
                                format: 'long' 
                            }) %>
                        </div>
                        <% } %>
                    </header>
                    <% } %>
                    
                    <%- pageContent %>
                    
                    <!-- Blog Footer with Categories and Tags -->
                    <% if ((page.categories && page.categories.length > 0) || (page.tags && page.tags.length > 0)) { %>
                    <footer class="blog-post-footer">
                        <% if (typeof the_categories !== 'undefined' && page.categories && page.categories.length > 0) { %>
                        <div class="blog-meta-categories">
                            <%- the_categories(page, { 
                                before: 'Categories: ',
                                separator: ', ',
                                pathToRoot: pathToRoot,
                                class: 'blog-category-badge' 
                            }) %>
                        </div>
                        <% } %>
                        
                        <% if (typeof the_tags !== 'undefined' && page.tags && page.tags.length > 0) { %>
                        <div class="blog-meta-tags">
                            <%- the_tags(page, { 
                                before: 'Tags: ',
                                separator: ', ',
                                pathToRoot: pathToRoot,
                                class: 'blog-tag-badge' 
                            }) %>
                        </div>
                        <% } %>
                    </footer>
                    <% } %>
                </div>

                <!-- Pagination (Previous/Next) -->
                <%- pagination %>
            </div>
        </main>
    </div>

    <!-- Footer -->
    <%- include('partials/footer', { copyrightYear, copyrightHolder, footerLegalLinks, companyUrl, logoFooterLight, logoFooterDark, logoAlt }) %>

    <!-- Mobile Overlay -->
    <div class="mobile-overlay" id="mobileOverlay"></div>

    <% if (menus?.ui_features?.scroll_to_top?.enabled === true) { %>
    <!-- Scroll to Top Button -->
    <button 
        class="scroll-to-top" 
        id="scrollToTop" 
        aria-label="Scroll to top of page"
        title="Scroll to top"
        type="button"
    >
        ↑
    </button>
    <% } %>

    <!-- Search Modal -->
    <%- include('partials/search-modal') %>

    <!-- Scripts -->
    <%- include('partials/scripts', { pathToRoot, i18nClientConfig, componentScripts, externalScripts }) %>
</body>
</html>
